{"ast":null,"code":"import _classCallCheck from \"C:/Users/deradoi/udemy/Crash Course - Build a Full Stack Web App/today-i-learned/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/deradoi/udemy/Crash Course - Build a Full Stack Web App/today-i-learned/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n// This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n// License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\nvar Serializer = /*#__PURE__*/function () {\n  function Serializer() {\n    _classCallCheck(this, Serializer);\n    this.HEADER_LENGTH = 1;\n  }\n  _createClass(Serializer, [{\n    key: \"decode\",\n    value: function decode(rawPayload, callback) {\n      if (rawPayload.constructor === ArrayBuffer) {\n        return callback(this._binaryDecode(rawPayload));\n      }\n      if (typeof rawPayload === 'string') {\n        return callback(JSON.parse(rawPayload));\n      }\n      return callback({});\n    }\n  }, {\n    key: \"_binaryDecode\",\n    value: function _binaryDecode(buffer) {\n      var view = new DataView(buffer);\n      var decoder = new TextDecoder();\n      return this._decodeBroadcast(buffer, view, decoder);\n    }\n  }, {\n    key: \"_decodeBroadcast\",\n    value: function _decodeBroadcast(buffer, view, decoder) {\n      var topicSize = view.getUint8(1);\n      var eventSize = view.getUint8(2);\n      var offset = this.HEADER_LENGTH + 2;\n      var topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n      offset = offset + topicSize;\n      var event = decoder.decode(buffer.slice(offset, offset + eventSize));\n      offset = offset + eventSize;\n      var data = JSON.parse(decoder.decode(buffer.slice(offset, buffer.byteLength)));\n      return {\n        ref: null,\n        topic: topic,\n        event: event,\n        payload: data\n      };\n    }\n  }]);\n  return Serializer;\n}();\nexport { Serializer as default };","map":{"version":3,"names":["Serializer","_classCallCheck","HEADER_LENGTH","_createClass","key","value","decode","rawPayload","callback","constructor","ArrayBuffer","_binaryDecode","JSON","parse","buffer","view","DataView","decoder","TextDecoder","_decodeBroadcast","topicSize","getUint8","eventSize","offset","topic","slice","event","data","byteLength","ref","payload","default"],"sources":["C:\\Users\\deradoi\\udemy\\Crash Course - Build a Full Stack Web App\\today-i-learned\\node_modules\\@supabase\\realtime-js\\src\\lib\\serializer.ts"],"sourcesContent":["// This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n// License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\n\nexport default class Serializer {\n  HEADER_LENGTH = 1\n\n  decode(rawPayload: ArrayBuffer | string, callback: Function) {\n    if (rawPayload.constructor === ArrayBuffer) {\n      return callback(this._binaryDecode(rawPayload))\n    }\n\n    if (typeof rawPayload === 'string') {\n      return callback(JSON.parse(rawPayload))\n    }\n\n    return callback({})\n  }\n\n  private _binaryDecode(buffer: ArrayBuffer) {\n    const view = new DataView(buffer)\n    const decoder = new TextDecoder()\n\n    return this._decodeBroadcast(buffer, view, decoder)\n  }\n\n  private _decodeBroadcast(\n    buffer: ArrayBuffer,\n    view: DataView,\n    decoder: TextDecoder\n  ): {\n    ref: null\n    topic: string\n    event: string\n    payload: { [key: string]: any }\n  } {\n    const topicSize = view.getUint8(1)\n    const eventSize = view.getUint8(2)\n    let offset = this.HEADER_LENGTH + 2\n    const topic = decoder.decode(buffer.slice(offset, offset + topicSize))\n    offset = offset + topicSize\n    const event = decoder.decode(buffer.slice(offset, offset + eventSize))\n    offset = offset + eventSize\n    const data = JSON.parse(\n      decoder.decode(buffer.slice(offset, buffer.byteLength))\n    )\n\n    return { ref: null, topic: topic, event: event, payload: data }\n  }\n}\n"],"mappings":";;AAAA;AACA;AAAA,IAEqBA,UAAU;EAA/B,SAAAA,WAAA;IAAAC,eAAA,OAAAD,UAAA;IACE,KAAAE,aAAa,GAAG,CAAC;EA4CnB;EAACC,YAAA,CAAAH,UAAA;IAAAI,GAAA;IAAAC,KAAA,EA1CC,SAAAC,OAAOC,UAAgC,EAAEC,QAAkB;MACzD,IAAID,UAAU,CAACE,WAAW,KAAKC,WAAW,EAAE;QAC1C,OAAOF,QAAQ,CAAC,IAAI,CAACG,aAAa,CAACJ,UAAU,CAAC,CAAC;;MAGjD,IAAI,OAAOA,UAAU,KAAK,QAAQ,EAAE;QAClC,OAAOC,QAAQ,CAACI,IAAI,CAACC,KAAK,CAACN,UAAU,CAAC,CAAC;;MAGzC,OAAOC,QAAQ,CAAC,EAAE,CAAC;IACrB;EAAC;IAAAJ,GAAA;IAAAC,KAAA,EAEO,SAAAM,cAAcG,MAAmB;MACvC,IAAMC,IAAI,GAAG,IAAIC,QAAQ,CAACF,MAAM,CAAC;MACjC,IAAMG,OAAO,GAAG,IAAIC,WAAW,EAAE;MAEjC,OAAO,IAAI,CAACC,gBAAgB,CAACL,MAAM,EAAEC,IAAI,EAAEE,OAAO,CAAC;IACrD;EAAC;IAAAb,GAAA;IAAAC,KAAA,EAEO,SAAAc,iBACNL,MAAmB,EACnBC,IAAc,EACdE,OAAoB;MAOpB,IAAMG,SAAS,GAAGL,IAAI,CAACM,QAAQ,CAAC,CAAC,CAAC;MAClC,IAAMC,SAAS,GAAGP,IAAI,CAACM,QAAQ,CAAC,CAAC,CAAC;MAClC,IAAIE,MAAM,GAAG,IAAI,CAACrB,aAAa,GAAG,CAAC;MACnC,IAAMsB,KAAK,GAAGP,OAAO,CAACX,MAAM,CAACQ,MAAM,CAACW,KAAK,CAACF,MAAM,EAAEA,MAAM,GAAGH,SAAS,CAAC,CAAC;MACtEG,MAAM,GAAGA,MAAM,GAAGH,SAAS;MAC3B,IAAMM,KAAK,GAAGT,OAAO,CAACX,MAAM,CAACQ,MAAM,CAACW,KAAK,CAACF,MAAM,EAAEA,MAAM,GAAGD,SAAS,CAAC,CAAC;MACtEC,MAAM,GAAGA,MAAM,GAAGD,SAAS;MAC3B,IAAMK,IAAI,GAAGf,IAAI,CAACC,KAAK,CACrBI,OAAO,CAACX,MAAM,CAACQ,MAAM,CAACW,KAAK,CAACF,MAAM,EAAET,MAAM,CAACc,UAAU,CAAC,CAAC,CACxD;MAED,OAAO;QAAEC,GAAG,EAAE,IAAI;QAAEL,KAAK,EAAEA,KAAK;QAAEE,KAAK,EAAEA,KAAK;QAAEI,OAAO,EAAEH;MAAI,CAAE;IACjE;EAAC;EAAA,OAAA3B,UAAA;AAAA;AAAA,SA5CkBA,UAAU,IAAA+B,OAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}