{"ast":null,"code":"import _toConsumableArray from \"C:/Users/deradoi/udemy/Crash Course - Build a Full Stack Web App/today-i-learned/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _classCallCheck from \"C:/Users/deradoi/udemy/Crash Course - Build a Full Stack Web App/today-i-learned/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/deradoi/udemy/Crash Course - Build a Full Stack Web App/today-i-learned/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n/*\n  This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n  License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n*/\nexport var REALTIME_PRESENCE_LISTEN_EVENTS;\n(function (REALTIME_PRESENCE_LISTEN_EVENTS) {\n  REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\n  REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\n  REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\n})(REALTIME_PRESENCE_LISTEN_EVENTS || (REALTIME_PRESENCE_LISTEN_EVENTS = {}));\nvar RealtimePresence = /*#__PURE__*/function () {\n  /**\n   * Initializes the Presence.\n   *\n   * @param channel - The RealtimeChannel\n   * @param opts - The options,\n   *        for example `{events: {state: 'state', diff: 'diff'}}`\n   */\n  function RealtimePresence(channel, opts) {\n    var _this = this;\n    _classCallCheck(this, RealtimePresence);\n    this.channel = channel;\n    this.state = {};\n    this.pendingDiffs = [];\n    this.joinRef = null;\n    this.caller = {\n      onJoin: function onJoin() {},\n      onLeave: function onLeave() {},\n      onSync: function onSync() {}\n    };\n    var events = (opts === null || opts === void 0 ? void 0 : opts.events) || {\n      state: 'presence_state',\n      diff: 'presence_diff'\n    };\n    this.channel._on(events.state, {}, function (newState) {\n      var _this$caller = _this.caller,\n        onJoin = _this$caller.onJoin,\n        onLeave = _this$caller.onLeave,\n        onSync = _this$caller.onSync;\n      _this.joinRef = _this.channel._joinRef();\n      _this.state = RealtimePresence.syncState(_this.state, newState, onJoin, onLeave);\n      _this.pendingDiffs.forEach(function (diff) {\n        _this.state = RealtimePresence.syncDiff(_this.state, diff, onJoin, onLeave);\n      });\n      _this.pendingDiffs = [];\n      onSync();\n    });\n    this.channel._on(events.diff, {}, function (diff) {\n      var _this$caller2 = _this.caller,\n        onJoin = _this$caller2.onJoin,\n        onLeave = _this$caller2.onLeave,\n        onSync = _this$caller2.onSync;\n      if (_this.inPendingSyncState()) {\n        _this.pendingDiffs.push(diff);\n      } else {\n        _this.state = RealtimePresence.syncDiff(_this.state, diff, onJoin, onLeave);\n        onSync();\n      }\n    });\n    this.onJoin(function (key, currentPresences, newPresences) {\n      _this.channel._trigger('presence', {\n        event: 'join',\n        key: key,\n        currentPresences: currentPresences,\n        newPresences: newPresences\n      });\n    });\n    this.onLeave(function (key, currentPresences, leftPresences) {\n      _this.channel._trigger('presence', {\n        event: 'leave',\n        key: key,\n        currentPresences: currentPresences,\n        leftPresences: leftPresences\n      });\n    });\n    this.onSync(function () {\n      _this.channel._trigger('presence', {\n        event: 'sync'\n      });\n    });\n  }\n  /**\n   * Used to sync the list of presences on the server with the\n   * client's state.\n   *\n   * An optional `onJoin` and `onLeave` callback can be provided to\n   * react to changes in the client's local presences across\n   * disconnects and reconnects with the server.\n   *\n   * @internal\n   */\n  _createClass(RealtimePresence, [{\n    key: \"onJoin\",\n    value: /** @internal */\n    function onJoin(callback) {\n      this.caller.onJoin = callback;\n    }\n    /** @internal */\n  }, {\n    key: \"onLeave\",\n    value: function onLeave(callback) {\n      this.caller.onLeave = callback;\n    }\n    /** @internal */\n  }, {\n    key: \"onSync\",\n    value: function onSync(callback) {\n      this.caller.onSync = callback;\n    }\n    /** @internal */\n  }, {\n    key: \"inPendingSyncState\",\n    value: function inPendingSyncState() {\n      return !this.joinRef || this.joinRef !== this.channel._joinRef();\n    }\n  }], [{\n    key: \"syncState\",\n    value: function syncState(currentState, newState, onJoin, onLeave) {\n      var state = this.cloneDeep(currentState);\n      var transformedState = this.transformState(newState);\n      var joins = {};\n      var leaves = {};\n      this.map(state, function (key, presences) {\n        if (!transformedState[key]) {\n          leaves[key] = presences;\n        }\n      });\n      this.map(transformedState, function (key, newPresences) {\n        var currentPresences = state[key];\n        if (currentPresences) {\n          var newPresenceRefs = newPresences.map(function (m) {\n            return m.presence_ref;\n          });\n          var curPresenceRefs = currentPresences.map(function (m) {\n            return m.presence_ref;\n          });\n          var joinedPresences = newPresences.filter(function (m) {\n            return curPresenceRefs.indexOf(m.presence_ref) < 0;\n          });\n          var leftPresences = currentPresences.filter(function (m) {\n            return newPresenceRefs.indexOf(m.presence_ref) < 0;\n          });\n          if (joinedPresences.length > 0) {\n            joins[key] = joinedPresences;\n          }\n          if (leftPresences.length > 0) {\n            leaves[key] = leftPresences;\n          }\n        } else {\n          joins[key] = newPresences;\n        }\n      });\n      return this.syncDiff(state, {\n        joins: joins,\n        leaves: leaves\n      }, onJoin, onLeave);\n    }\n    /**\n     * Used to sync a diff of presence join and leave events from the\n     * server, as they happen.\n     *\n     * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n     * `onLeave` callbacks to react to a user joining or leaving from a\n     * device.\n     *\n     * @internal\n     */\n  }, {\n    key: \"syncDiff\",\n    value: function syncDiff(state, diff, onJoin, onLeave) {\n      var _this2 = this;\n      var _joins$leaves = {\n          joins: this.transformState(diff.joins),\n          leaves: this.transformState(diff.leaves)\n        },\n        joins = _joins$leaves.joins,\n        leaves = _joins$leaves.leaves;\n      if (!onJoin) {\n        onJoin = function onJoin() {};\n      }\n      if (!onLeave) {\n        onLeave = function onLeave() {};\n      }\n      this.map(joins, function (key, newPresences) {\n        var _a;\n        var currentPresences = (_a = state[key]) !== null && _a !== void 0 ? _a : [];\n        state[key] = _this2.cloneDeep(newPresences);\n        if (currentPresences.length > 0) {\n          var _state$key;\n          var joinedPresenceRefs = state[key].map(function (m) {\n            return m.presence_ref;\n          });\n          var curPresences = currentPresences.filter(function (m) {\n            return joinedPresenceRefs.indexOf(m.presence_ref) < 0;\n          });\n          (_state$key = state[key]).unshift.apply(_state$key, _toConsumableArray(curPresences));\n        }\n        onJoin(key, currentPresences, newPresences);\n      });\n      this.map(leaves, function (key, leftPresences) {\n        var currentPresences = state[key];\n        if (!currentPresences) return;\n        var presenceRefsToRemove = leftPresences.map(function (m) {\n          return m.presence_ref;\n        });\n        currentPresences = currentPresences.filter(function (m) {\n          return presenceRefsToRemove.indexOf(m.presence_ref) < 0;\n        });\n        state[key] = currentPresences;\n        onLeave(key, currentPresences, leftPresences);\n        if (currentPresences.length === 0) delete state[key];\n      });\n      return state;\n    }\n    /** @internal */\n  }, {\n    key: \"map\",\n    value: function map(obj, func) {\n      return Object.getOwnPropertyNames(obj).map(function (key) {\n        return func(key, obj[key]);\n      });\n    }\n    /**\n     * Remove 'metas' key\n     * Change 'phx_ref' to 'presence_ref'\n     * Remove 'phx_ref' and 'phx_ref_prev'\n     *\n     * @example\n     * // returns {\n     *  abc123: [\n     *    { presence_ref: '2', user_id: 1 },\n     *    { presence_ref: '3', user_id: 2 }\n     *  ]\n     * }\n     * RealtimePresence.transformState({\n     *  abc123: {\n     *    metas: [\n     *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n     *      { phx_ref: '3', user_id: 2 }\n     *    ]\n     *  }\n     * })\n     *\n     * @internal\n     */\n  }, {\n    key: \"transformState\",\n    value: function transformState(state) {\n      state = this.cloneDeep(state);\n      return Object.getOwnPropertyNames(state).reduce(function (newState, key) {\n        var presences = state[key];\n        if ('metas' in presences) {\n          newState[key] = presences.metas.map(function (presence) {\n            presence['presence_ref'] = presence['phx_ref'];\n            delete presence['phx_ref'];\n            delete presence['phx_ref_prev'];\n            return presence;\n          });\n        } else {\n          newState[key] = presences;\n        }\n        return newState;\n      }, {});\n    }\n    /** @internal */\n  }, {\n    key: \"cloneDeep\",\n    value: function cloneDeep(obj) {\n      return JSON.parse(JSON.stringify(obj));\n    }\n  }]);\n  return RealtimePresence;\n}();\nexport { RealtimePresence as default };","map":{"version":3,"names":["REALTIME_PRESENCE_LISTEN_EVENTS","RealtimePresence","channel","opts","_this","_classCallCheck","state","pendingDiffs","joinRef","caller","onJoin","onLeave","onSync","events","diff","_on","newState","_this$caller","_joinRef","syncState","forEach","syncDiff","_this$caller2","inPendingSyncState","push","key","currentPresences","newPresences","_trigger","event","leftPresences","_createClass","value","callback","currentState","cloneDeep","transformedState","transformState","joins","leaves","map","presences","newPresenceRefs","m","presence_ref","curPresenceRefs","joinedPresences","filter","indexOf","length","_this2","_joins$leaves","_a","_state$key","joinedPresenceRefs","curPresences","unshift","apply","_toConsumableArray","presenceRefsToRemove","obj","func","Object","getOwnPropertyNames","reduce","metas","presence","JSON","parse","stringify","default"],"sources":["C:\\Users\\deradoi\\udemy\\Crash Course - Build a Full Stack Web App\\today-i-learned\\node_modules\\@supabase\\realtime-js\\src\\RealtimePresence.ts"],"sourcesContent":["/*\n  This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n  License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n*/\n\nimport type {\n  PresenceOpts,\n  PresenceOnJoinCallback,\n  PresenceOnLeaveCallback,\n} from 'phoenix'\nimport type RealtimeChannel from './RealtimeChannel'\n\ntype Presence<T extends { [key: string]: any } = {}> = {\n  presence_ref: string\n} & T\n\nexport type RealtimePresenceState<T extends { [key: string]: any } = {}> = {\n  [key: string]: Presence<T>[]\n}\n\nexport type RealtimePresenceJoinPayload<T extends { [key: string]: any }> = {\n  event: `${REALTIME_PRESENCE_LISTEN_EVENTS.JOIN}`\n  key: string\n  currentPresences: Presence<T>[]\n  newPresences: Presence<T>[]\n}\n\nexport type RealtimePresenceLeavePayload<T extends { [key: string]: any }> = {\n  event: `${REALTIME_PRESENCE_LISTEN_EVENTS.LEAVE}`\n  key: string\n  currentPresences: Presence<T>[]\n  leftPresences: Presence<T>[]\n}\n\nexport enum REALTIME_PRESENCE_LISTEN_EVENTS {\n  SYNC = 'sync',\n  JOIN = 'join',\n  LEAVE = 'leave',\n}\n\ntype PresenceDiff = {\n  joins: RealtimePresenceState\n  leaves: RealtimePresenceState\n}\n\ntype RawPresenceState = {\n  [key: string]: {\n    metas: {\n      phx_ref?: string\n      phx_ref_prev?: string\n      [key: string]: any\n    }[]\n  }\n}\n\ntype RawPresenceDiff = {\n  joins: RawPresenceState\n  leaves: RawPresenceState\n}\n\ntype PresenceChooser<T> = (key: string, presences: Presence[]) => T\n\nexport default class RealtimePresence {\n  state: RealtimePresenceState = {}\n  pendingDiffs: RawPresenceDiff[] = []\n  joinRef: string | null = null\n  caller: {\n    onJoin: PresenceOnJoinCallback\n    onLeave: PresenceOnLeaveCallback\n    onSync: () => void\n  } = {\n    onJoin: () => {},\n    onLeave: () => {},\n    onSync: () => {},\n  }\n\n  /**\n   * Initializes the Presence.\n   *\n   * @param channel - The RealtimeChannel\n   * @param opts - The options,\n   *        for example `{events: {state: 'state', diff: 'diff'}}`\n   */\n  constructor(public channel: RealtimeChannel, opts?: PresenceOpts) {\n    const events = opts?.events || {\n      state: 'presence_state',\n      diff: 'presence_diff',\n    }\n\n    this.channel._on(events.state, {}, (newState: RawPresenceState) => {\n      const { onJoin, onLeave, onSync } = this.caller\n\n      this.joinRef = this.channel._joinRef()\n\n      this.state = RealtimePresence.syncState(\n        this.state,\n        newState,\n        onJoin,\n        onLeave\n      )\n\n      this.pendingDiffs.forEach((diff) => {\n        this.state = RealtimePresence.syncDiff(\n          this.state,\n          diff,\n          onJoin,\n          onLeave\n        )\n      })\n\n      this.pendingDiffs = []\n\n      onSync()\n    })\n\n    this.channel._on(events.diff, {}, (diff: RawPresenceDiff) => {\n      const { onJoin, onLeave, onSync } = this.caller\n\n      if (this.inPendingSyncState()) {\n        this.pendingDiffs.push(diff)\n      } else {\n        this.state = RealtimePresence.syncDiff(\n          this.state,\n          diff,\n          onJoin,\n          onLeave\n        )\n\n        onSync()\n      }\n    })\n\n    this.onJoin((key, currentPresences, newPresences) => {\n      this.channel._trigger('presence', {\n        event: 'join',\n        key,\n        currentPresences,\n        newPresences,\n      })\n    })\n\n    this.onLeave((key, currentPresences, leftPresences) => {\n      this.channel._trigger('presence', {\n        event: 'leave',\n        key,\n        currentPresences,\n        leftPresences,\n      })\n    })\n\n    this.onSync(() => {\n      this.channel._trigger('presence', { event: 'sync' })\n    })\n  }\n\n  /**\n   * Used to sync the list of presences on the server with the\n   * client's state.\n   *\n   * An optional `onJoin` and `onLeave` callback can be provided to\n   * react to changes in the client's local presences across\n   * disconnects and reconnects with the server.\n   *\n   * @internal\n   */\n  private static syncState(\n    currentState: RealtimePresenceState,\n    newState: RawPresenceState | RealtimePresenceState,\n    onJoin: PresenceOnJoinCallback,\n    onLeave: PresenceOnLeaveCallback\n  ): RealtimePresenceState {\n    const state = this.cloneDeep(currentState)\n    const transformedState = this.transformState(newState)\n    const joins: RealtimePresenceState = {}\n    const leaves: RealtimePresenceState = {}\n\n    this.map(state, (key: string, presences: Presence[]) => {\n      if (!transformedState[key]) {\n        leaves[key] = presences\n      }\n    })\n\n    this.map(transformedState, (key, newPresences: Presence[]) => {\n      const currentPresences: Presence[] = state[key]\n\n      if (currentPresences) {\n        const newPresenceRefs = newPresences.map(\n          (m: Presence) => m.presence_ref\n        )\n        const curPresenceRefs = currentPresences.map(\n          (m: Presence) => m.presence_ref\n        )\n        const joinedPresences: Presence[] = newPresences.filter(\n          (m: Presence) => curPresenceRefs.indexOf(m.presence_ref) < 0\n        )\n        const leftPresences: Presence[] = currentPresences.filter(\n          (m: Presence) => newPresenceRefs.indexOf(m.presence_ref) < 0\n        )\n\n        if (joinedPresences.length > 0) {\n          joins[key] = joinedPresences\n        }\n\n        if (leftPresences.length > 0) {\n          leaves[key] = leftPresences\n        }\n      } else {\n        joins[key] = newPresences\n      }\n    })\n\n    return this.syncDiff(state, { joins, leaves }, onJoin, onLeave)\n  }\n\n  /**\n   * Used to sync a diff of presence join and leave events from the\n   * server, as they happen.\n   *\n   * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n   * `onLeave` callbacks to react to a user joining or leaving from a\n   * device.\n   *\n   * @internal\n   */\n  private static syncDiff(\n    state: RealtimePresenceState,\n    diff: RawPresenceDiff | PresenceDiff,\n    onJoin: PresenceOnJoinCallback,\n    onLeave: PresenceOnLeaveCallback\n  ): RealtimePresenceState {\n    const { joins, leaves } = {\n      joins: this.transformState(diff.joins),\n      leaves: this.transformState(diff.leaves),\n    }\n\n    if (!onJoin) {\n      onJoin = () => {}\n    }\n\n    if (!onLeave) {\n      onLeave = () => {}\n    }\n\n    this.map(joins, (key, newPresences: Presence[]) => {\n      const currentPresences: Presence[] = state[key] ?? []\n      state[key] = this.cloneDeep(newPresences)\n\n      if (currentPresences.length > 0) {\n        const joinedPresenceRefs = state[key].map(\n          (m: Presence) => m.presence_ref\n        )\n        const curPresences: Presence[] = currentPresences.filter(\n          (m: Presence) => joinedPresenceRefs.indexOf(m.presence_ref) < 0\n        )\n\n        state[key].unshift(...curPresences)\n      }\n\n      onJoin(key, currentPresences, newPresences)\n    })\n\n    this.map(leaves, (key, leftPresences: Presence[]) => {\n      let currentPresences: Presence[] = state[key]\n\n      if (!currentPresences) return\n\n      const presenceRefsToRemove = leftPresences.map(\n        (m: Presence) => m.presence_ref\n      )\n      currentPresences = currentPresences.filter(\n        (m: Presence) => presenceRefsToRemove.indexOf(m.presence_ref) < 0\n      )\n\n      state[key] = currentPresences\n\n      onLeave(key, currentPresences, leftPresences)\n\n      if (currentPresences.length === 0) delete state[key]\n    })\n\n    return state\n  }\n\n  /** @internal */\n  private static map<T = any>(\n    obj: RealtimePresenceState,\n    func: PresenceChooser<T>\n  ): T[] {\n    return Object.getOwnPropertyNames(obj).map((key) => func(key, obj[key]))\n  }\n\n  /**\n   * Remove 'metas' key\n   * Change 'phx_ref' to 'presence_ref'\n   * Remove 'phx_ref' and 'phx_ref_prev'\n   *\n   * @example\n   * // returns {\n   *  abc123: [\n   *    { presence_ref: '2', user_id: 1 },\n   *    { presence_ref: '3', user_id: 2 }\n   *  ]\n   * }\n   * RealtimePresence.transformState({\n   *  abc123: {\n   *    metas: [\n   *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n   *      { phx_ref: '3', user_id: 2 }\n   *    ]\n   *  }\n   * })\n   *\n   * @internal\n   */\n  private static transformState(\n    state: RawPresenceState | RealtimePresenceState\n  ): RealtimePresenceState {\n    state = this.cloneDeep(state)\n\n    return Object.getOwnPropertyNames(state).reduce((newState, key) => {\n      const presences = state[key]\n\n      if ('metas' in presences) {\n        newState[key] = presences.metas.map((presence) => {\n          presence['presence_ref'] = presence['phx_ref']\n\n          delete presence['phx_ref']\n          delete presence['phx_ref_prev']\n\n          return presence\n        }) as Presence[]\n      } else {\n        newState[key] = presences\n      }\n\n      return newState\n    }, {} as RealtimePresenceState)\n  }\n\n  /** @internal */\n  private static cloneDeep(obj: { [key: string]: any }) {\n    return JSON.parse(JSON.stringify(obj))\n  }\n\n  /** @internal */\n  private onJoin(callback: PresenceOnJoinCallback): void {\n    this.caller.onJoin = callback\n  }\n\n  /** @internal */\n  private onLeave(callback: PresenceOnLeaveCallback): void {\n    this.caller.onLeave = callback\n  }\n\n  /** @internal */\n  private onSync(callback: () => void): void {\n    this.caller.onSync = callback\n  }\n\n  /** @internal */\n  private inPendingSyncState(): boolean {\n    return !this.joinRef || this.joinRef !== this.channel._joinRef()\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}